<!DOCTYPE html>

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title>Chess</title>
        <style>
            .greenname {
                background: #82ca13;
                color: green;
                border: 1px solid green;
                border-radius: 0.1em;
            }
            .yellowname {
                background: #82ca13;
                color: #f9cf82;
                border: 1px solid green;
                border-radius: 0.1em;
            }
            .highlight {
                color: red;
            }
            
            .table,table tr th, table tr td {
                border:1px solid rgb(185, 185, 185); 
            }
            .table tr th, .table tr td {
                min-width: 48px;
            }
            .table tr {
                height: 51px;
            }
            .table {
                text-align: center; 
                border-collapse: collapse; 
                padding:2px;
                border-radius: 5px;
            }
            .hide {
                background: #eaeaea;
                cursor: pointer;
            }

            .go-empty {
                border: 3px solid rgb(6, 248, 127); 
                background: rgba(6, 248, 127, 0.2);
                width: 46px; 
                height: 46px;
                position: absolute;
                cursor: pointer;
            }
            .go-kill {
                z-index: 1000;
                border: 3px solid rgb(248, 75, 6); 
                background: rgba(248, 75, 6, 0.2);
                width: 46px; 
                height: 46px;
                position: absolute;
                cursor: pointer;
            }

            .piece {
                padding-top: 12px; 
                text-align: center; 
                border: 1px solid rgb(185, 185, 185); 
                border-radius: 50%; 
                width: 50px; 
                height: 38px;
                position: absolute;
                color: white;
            }
            .teami {
                background: red;
            }
            .teamii {
                background: blue;
            }
            .instr {
                background: grey;
            }

            .box {
                position: absolute;
                z-index: 1000;
                padding: 5px 0;
                list-style: none;
                font-size: 14px;
                text-align: left;
                background-color: #fff;
                border: 1px solid rgba(0,0,0,0.15);
                border-radius: 3px;
                box-shadow: 0 6px 12px rgb(0 0 0 / 18%);
                background-clip: padding-box;
            }

            .button {
                border-radius: 50%; 
                display: inline-block; 
                margin: 0 4px; 
                padding: 12px;
                overflow: hidden; 
                vertical-align: middle; 
                cursor: pointer; 
                height: 24px; 
                width: 24px; 
                flex: 0 0 auto; 
                white-space: nowrap; 
                font: 13px/27px Roboto,RobotoDraft,Arial,sans-serif; 
                z-index: 986;
            }
            .button:hover {
                background: #eaeaea;
            }
/* 
            @keyframes rotateGreen {
                from {
                    transform-origin: 50% 50%;
                    transform: rotate(0deg);
                }
                to {
                    transform-origin: 50% 50%;
                    transform: rotate(120deg);
                }
            } */
        </style>
        <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
        <script>
            function new_web(webUrl)
            {
                window.open(webUrl); 
            }
            function open_web(webUrl)
            {
                location = webUrl; 
            }
            function mathjax_dy(elementId) {
                if (!window.MathJax) {
                    return;
                }
                window.MathJax.Hub.Queue(["Typeset", window.MathJax.Hub, document.getElementById(elementId)]);
            }
            function pos(x, y)
            {
                return "top: " + (8 + Number(x) * 51) + "px; left: " + (8 + Number(y) * 51) + "px;"; 
            }
            var board = [[-1, -1, -1, -1, -1, -1, -1, -1], [-1, -1, -1, -1, -1, -1, -1, -1], 
            [-1, -1, -1, -1, -1, -1, -1, -1], [-1, -1, -1, -1, -1, -1, -1, -1], 
            [-1, -1, -1, -1, -1, -1, -1, -1], [-1, -1, -1, -1, -1, -1, -1, -1], 
            [-1, -1, -1, -1, -1, -1, -1, -1], [-1, -1, -1, -1, -1, -1, -1, -1]]; 
            var shown = [[-1, -1, -1, -1, -1, -1, -1, -1], [-1, -1, -1, -1, -1, -1, -1, -1], 
            [-1, -1, -1, -1, -1, -1, -1, -1], [-1, -1, -1, -1, -1, -1, -1, -1], 
            [-1, -1, -1, -1, -1, -1, -1, -1], [-1, -1, -1, -1, -1, -1, -1, -1], 
            [-1, -1, -1, -1, -1, -1, -1, -1], [-1, -1, -1, -1, -1, -1, -1, -1]]; 
            var nam = [["ybj", "cyb"], ["wyx", "kyl"], ["lt", "qjh"], 
            ["fyh", "sbw", "xry", "qhy", "yxd"], ["mbj", "kpq", "yzh", "hyk"], 
            ["zcx"], ["ztzy"], ["lyf"]]; 
            var nameCN = [["俞伯驹", "陈怿白"], ["王聿煊", "阚云雷"], ["刘涛", "钱锦鸿"], 
            ["范语涵", "孙博为", "熊若渔", "邱泓议", "郁肖栋"], ["马伯驹", "阚皮球", "姚宗昊", "华奕开"], 
            ["曾楚笑"], ["张田泽宇"], ["吕一凡"]]; 
            var blood = [[4, 4], [2, 4], [4, 4], [3, 1, 4, 4, 6], [4, 4, 4, 4], [3], [4], [1]]; 
            var player = 0; 
            var going = 0; 
            var killedi = 0, killedii = 0; 
            window.onload = function() {
                $("#board tr td").addClass("hide"); 
                for (let i = 0; i < 8; i++)
                {
                    let xI = Math.floor(Math.random() * 1000) % 8,
                    yI = Math.floor(Math.random() * 999) % 8; 
                    while (board[xI][yI] != -1) xI = Math.floor(Math.random() * 1000) % 8,
                    yI = Math.floor(Math.random() * 999) % 8; 
                    let nameINum = Math.floor(Math.random() * 999) % nam[i].length; 
                    let nameI = nam[i][nameINum]; 
                    document.body.innerHTML += "<div class=\"piece teami\" id=\"piece" + i
                    + "\" style=\"" + pos(xI, yI) + "display: none;\" onclick=\"control(" + xI + ", " + yI
                    + ")\">" + nameI + "</div>"; 
                    board[xI][yI] = [0, i, nameINum, blood[i][nameINum]]; 
                }
                for (let i = 0; i < 8; i++)
                {
                    let xI = Math.floor(Math.random() * 1000) % 8,
                    yI = Math.floor(Math.random() * 999) % 8; 
                    while (board[xI][yI] != -1) xI = Math.floor(Math.random() * 1000) % 8,
                    yI = Math.floor(Math.random() * 999) % 8; 
                    let nameINum = Math.floor(Math.random() * 999) % nam[i].length; 
                    let nameI = nam[i][nameINum]; 
                    document.body.innerHTML += "<div class=\"piece teamii\" id=\"piece" + String(Number(i) + 16)
                    + "\" style=\"" + pos(xI, yI) + "display: none;\" onclick=\"control(" + xI + ", " + yI
                    + ")\">" + nameI + "</div>"; 
                    board[xI][yI] = [1, i, nameINum, blood[i][nameINum]]; 
                }
                for (let i = 0; i < 8; i++)
                {
                    for (let j = 0; j < nam[i].length; j++)
                    document.body.innerHTML += "<div class=\"piece instr\" style=\""
                    + pos(i, j + 12) + "\">" + nam[i][j] + "</div>"; 
                }
            }
            function showPiece(x, y) {
                $("#go").empty(); 
                $("#control").fadeOut(); 
                going = 0; 
                let boardXY = board[x][y]; 
                $("#board").children("tr").eq(x).children("td").eq(y).removeClass("hide"); 
                if (boardXY != -1) document.getElementById("piece"
                + String(Number(boardXY[0]) * 16 + Number(boardXY[1]))).style.display = "inline"; 
                player = 1 - player; 
                if (player == 0) document.getElementById("player").style.background = "red"; 
                else document.getElementById("player").style.background = "blue"; 
                shown[x][y] = 0; 
            }
            function openName(name)
            {
                localStorage.setItem("school.resume.name", name); 
                localStorage.setItem("school.resume.logged", "logged"); 
                new_web("../.."); 
            }
            function control(x, y) {$("#control").fadeToggle(function () {
                $("#blood").empty(); 
                let boardXY = board[x][y]; 
                let srcXY = "../../img/"; 
                if (nam[boardXY[1]][boardXY[2]] == "lyf") srcXY += "lyf.gif"; 
                else srcXY += nam[boardXY[1]][boardXY[2]] + ".png"; 
                document.getElementById("control-img").src = srcXY; 
                document.getElementById("control-name").innerHTML = nameCN[boardXY[1]][boardXY[2]]; 
                // if (document.getElementById("control").style.display = "none")
                // document.getElementById("control").style.display = "inline";
                // else document.getElementById("control").style.display = "none";
                document.getElementById("control").style.left = String(8 + (Number(y) + 1) * 51) + "px"; 
                document.getElementById("control").style.top = String(8 + (Number(x) + 1) * 51) + "px"; 
                for (let i = 0; i < boardXY[3]; i++) document.getElementById("blood").innerHTML
                += "<img src=\"../../img/heart.png\" style=\"width: 25px\">"; 
                if (player == boardXY[0] && going == 0)
                {
                    going = 2; 
                    let dx = [-1, 0, 1, 0], dy = [0, -1, 0, 1]; 
                    for (let d = 0; d < 4; d++)
                    {
                        let nx = Number(x) + Number(dx[d]), ny = Number(y) + Number(dy[d]); 
                        if (nx < 0 || nx >= 8 || ny < 0 || ny >= 8) continue; 
                        if (board[nx][ny][0] == player || shown[nx][ny] == -1) continue; 
                        if (board[nx][ny] == -1) document.getElementById("go").innerHTML
                        += "<div class=\"go-empty\" onclick=\"go(" + x + ", " + y + ", "
                        + nx + ", " + ny + ")\" style=\"" + pos(nx, ny) + "\"></div>"; 
                        else if (board[nx][ny][0] != player && board[nx][ny][1] >= board[x][y][1]){
                        document.getElementById("go").innerHTML
                        += "<div class=\"go-kill\" onclick=\"go(" + x + ", " + y + ", "
                        + nx + ", " + ny + ")\" style=\"" + pos(nx, ny) + "\"></div>"; 
                        }
                    }
                }
                if (going == 1)
                {
                    $("#go").empty(); 
                    going = 0; 
                }
                if (going == 2) going = 1; 
            }); }
            function min(a, b) {
                if (a<b)return a; return b; 
            }
            function go(x, y, nx, ny) {
                let bxy = board[x][y], nbxy = board[nx][ny]; 
                $("#go").empty(); 
                $("#control").fadeOut(); 
                going = 0; 
                player = 1 - player; 
                if (player == 0) document.getElementById("player").style.background = "red"; 
                else document.getElementById("player").style.background = "blue"; 
                if (nbxy == -1)
                {
                    document.getElementById("piece"
                    + String(Number(bxy[0]) * 16 + Number(bxy[1]))).onclick = function() {
                        control(nx, ny); 
                    }
                    document.getElementById("piece"
                    + String(Number(bxy[0]) * 16 + Number(bxy[1]))).style = pos(nx, ny); 
                    board[x][y] = -1; board[nx][ny] = bxy; 
                }
                else
                {
                    board[nx][ny][3] -= 2; 
                    board[x][y][3]--; 
                    nbxy = board[nx][ny]; bxy = board[x][y]; 
                    if (nbxy[3] <= 0) {
                        if (nbxy[0] == 0) document.getElementById("piece"
                        + String(Number(nbxy[0]) * 16 + Number(nbxy[1]))).style = pos(killedi++, 9); 
                        else document.getElementById("piece"
                        + String(Number(nbxy[0]) * 16 + Number(nbxy[1]))).style = pos(killedii++, 10); 
                        if (killedi == 8)
                        {
                            alert("Blue Wins!"); 
                            location.reload(); 
                        }
                        else if (killedii == 8)
                        {
                            alert("Red Wins!"); 
                            location.reload(); 
                        }
                        document.getElementById("piece"
                        + String(Number(nbxy[0]) * 16 + Number(nbxy[1]))).onclick = function () {}; 
                        document.getElementById("piece"
                        + String(Number(bxy[0]) * 16 + Number(bxy[1]))).onclick = function() {
                            control(nx, ny); 
                        }
                        document.getElementById("piece"
                        + String(Number(bxy[0]) * 16 + Number(bxy[1]))).style = pos(nx, ny); 
                        board[x][y] = -1; board[nx][ny] = bxy; 
                    }
                    if (bxy[3] <= 0) {
                        if (bxy[0] == 0) document.getElementById("piece"
                        + String(Number(bxy[0]) * 16 + Number(bxy[1]))).style = pos(killedi++, 9); 
                        else document.getElementById("piece"
                        + String(Number(bxy[0]) * 16 + Number(bxy[1]))).style = pos(killedii++, 10); 
                        if (killedi == 8)
                        {
                            alert("Blue Wins!"); 
                            location.reload(); 
                        }
                        else if (killedii == 8)
                        {
                            alert("Red Wins!"); 
                            location.reload(); 
                        }
                        document.getElementById("piece"
                        + String(Number(bxy[0]) * 16 + Number(bxy[1]))).onclick = function () {}; 
                        board[x][y] = -1;
                    }
                }
            }
            function giveUp() {
                if (player == 0)
                {
                    alert("Blue Wins!"); 
                    location.reload(); 
                }
                else
                {
                    alert("Red Wins!"); 
                    location.reload(); 
                }
            }
        </script>
    </head>
    <body>
        <table class="table">
            <tbody id="board">
                <tr><td onclick="showPiece(0, 0)"></td><td onclick="showPiece(0, 1)"></td>
                    <td onclick="showPiece(0, 2)"></td><td onclick="showPiece(0, 3)"></td>
                    <td onclick="showPiece(0, 4)"></td><td onclick="showPiece(0, 5)"></td>
                    <td onclick="showPiece(0, 6)"></td><td onclick="showPiece(0, 7)"></td></tr>
                <tr><td onclick="showPiece(1, 0)"></td><td onclick="showPiece(1, 1)"></td>
                    <td onclick="showPiece(1, 2)"></td><td onclick="showPiece(1, 3)"></td>
                    <td onclick="showPiece(1, 4)"></td><td onclick="showPiece(1, 5)"></td>
                    <td onclick="showPiece(1, 6)"></td><td onclick="showPiece(1, 7)"></td></tr>
                <tr><td onclick="showPiece(2, 0)"></td><td onclick="showPiece(2, 1)"></td>
                    <td onclick="showPiece(2, 2)"></td><td onclick="showPiece(2, 3)"></td>
                    <td onclick="showPiece(2, 4)"></td><td onclick="showPiece(2, 5)"></td>
                    <td onclick="showPiece(2, 6)"></td><td onclick="showPiece(2, 7)"></td></tr>
                <tr><td onclick="showPiece(3, 0)"></td><td onclick="showPiece(3, 1)"></td>
                    <td onclick="showPiece(3, 2)"></td><td onclick="showPiece(3, 3)"></td>
                    <td onclick="showPiece(3, 4)"></td><td onclick="showPiece(3, 5)"></td>
                    <td onclick="showPiece(3, 6)"></td><td onclick="showPiece(3, 7)"></td></tr>
                <tr><td onclick="showPiece(4, 0)"></td><td onclick="showPiece(4, 1)"></td>
                    <td onclick="showPiece(4, 2)"></td><td onclick="showPiece(4, 3)"></td>
                    <td onclick="showPiece(4, 4)"></td><td onclick="showPiece(4, 5)"></td>
                    <td onclick="showPiece(4, 6)"></td><td onclick="showPiece(4, 7)"></td></tr>
                <tr><td onclick="showPiece(5, 0)"></td><td onclick="showPiece(5, 1)"></td>
                    <td onclick="showPiece(5, 2)"></td><td onclick="showPiece(5, 3)"></td>
                    <td onclick="showPiece(5, 4)"></td><td onclick="showPiece(5, 5)"></td>
                    <td onclick="showPiece(5, 6)"></td><td onclick="showPiece(5, 7)"></td></tr>
                <tr><td onclick="showPiece(6, 0)"></td><td onclick="showPiece(6, 1)"></td>
                    <td onclick="showPiece(6, 2)"></td><td onclick="showPiece(6, 3)"></td>
                    <td onclick="showPiece(6, 4)"></td><td onclick="showPiece(6, 5)"></td>
                    <td onclick="showPiece(6, 6)"></td><td onclick="showPiece(6, 7)"></td></tr>
                <tr><td onclick="showPiece(7, 0)"></td><td onclick="showPiece(7, 1)"></td>
                    <td onclick="showPiece(7, 2)"></td><td onclick="showPiece(7, 3)"></td>
                    <td onclick="showPiece(7, 4)"></td><td onclick="showPiece(7, 5)"></td>
                    <td onclick="showPiece(7, 6)"></td><td onclick="showPiece(7, 7)"></td></tr>
            </tbody>
        </table>
        <div class="box" id="control"
        style="position: absolute; left: 8px; top: 59px; padding: 20px 20px 10px 20px; display: none;">
            <img id="control-img" src="../../img/lyf.gif" style="height: 100px;"><br>
            <b onclick="openName(this.innerHTML)" style="cursor: pointer;" id="control-name"></b>
            <div id="blood"></div>
        </div>
        <div class="button" onclick="location = '../'" style="position: absolute; bottom: 5px; left: 8px;">
            <img src="https://www.gstatic.com/images/icons/material/system_gm/1x/home_black_24dp.png">
        </div>
        <div class="button" onclick="giveUp()" style="position: absolute; bottom: 5px; left: 56px;">
            <img src="https://www.gstatic.com/images/icons/material/system_gm/1x/chat_black_24dp.png">
        </div>
        <div class="button" onclick="alert('The higher level pieces can eat the lower ones. ')"
        style="position: absolute; bottom: 5px; left: 104px;">
            <img src="https://www.gstatic.com/images/icons/material/system_gm/1x/help_black_24dp.png">
        </div>
        <div class="button"
        style="position: absolute; bottom: 5px; right: 8px; cursor: auto;">
            <div style="background: red; width: 20px; height: 20px;
            margin-left: 2px; margin-top: 2px;" id="player"></div>
        </div>
        <div id="go"></div>
    </body>
</html>